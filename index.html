<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Excel Glass Tabs - Pinch Zoom Content Only</title>

<style>
/* ====== GLOBAL ======= */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: system-ui, sans-serif;
}

body {
  height: 100vh;
  background: #d3d3d3;
  padding: 2px 0 56px;
  overflow: hidden;
}

/* ====== WRAPPER ======= */
.excel-wrapper {
  width: 100vw;
  height: calc(100vh - 56px);
  display: flex;
  flex-direction: column;
  border-radius: 10px;
  overflow: hidden;

  background: rgba(255,255,255,0.25);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
}

/* TITLE BAR */
.title-bar {
  height: 4px;
  transition: background 0.3s;
}

/* CONTENT AREA */
.content-area {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* SCROLL + PINCH */
.inner-content {
  flex: 1;
  padding: 0;
  overflow: auto;
  background: rgba(255,255,255,0.6);
  backdrop-filter: blur(18px);
  touch-action: none;
}

/* wrapper zoom */
.zoom-wrapper {
  transform-origin: top left;
  padding: 2px;
}

/* ====== TAB BAR ======= */
.sheet-tabs-bar {
  height: 60px;
  display: flex;
  align-items: flex-end;
  transition: background 0.25s;
}

/* TAB BUTTON */
.sheet-tab {
  width: 25%;
  padding: 14px 10px;
  text-align: center;
  font-size: 13px;
  cursor: pointer;
  background: rgba(255,255,255,0.5);
  color: #000;
  margin-top: 10px;
  transition: 0.15s;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.sheet-tab.active {
  color: white;
  font-weight: 700;
  transform: translateY(-3px);
  background: var(--activeColor);
  border-radius: 12px 12px 0 0;
  box-shadow: 0 0 18px var(--glowColor);
}

/* Animations */
.slide-from-right { animation: slideFromRight .28s ease-out; }
.slide-from-left  { animation: slideFromLeft  .28s ease-out; }

@keyframes slideFromRight { from {opacity:0; transform:translateX(40px);} to {opacity:1; transform:translateX(0);} }
@keyframes slideFromLeft  { from {opacity:0; transform:translateX(-40px);} to {opacity:1; transform:translateX(0);} }

/* RESPONSIVE */
@media (max-width: 600px) {
  body { padding: 0 0 56px; }
  .excel-wrapper { border-radius: 0; height: calc(100vh - 56px); }
  .sheet-tabs-bar { height: 48px; }
  .sheet-tab { padding: 10px 4px; font-size: 11px; }
}

/* ===========================================================
   KOTAK & KARTU KRN
=========================================================== */

.krn-box {
  width: 100%;
  height: calc(100vh - 56px - 4px - 60px);
  display: flex;
  flex-direction: column;
  gap: 12px;

  background: linear-gradient(180deg,#E3F2FF 0%,#B8DCFF 50%,#8CC4FF 100%);
  padding: 10px;
  border-radius: 12px;
  border: 3px solid black;
}

.krn-img {
  height: 40%;
  width: 100%;
  object-fit: contain;
  background: #ffffff;
  border-radius: 14px;
}

.krn-title {
  font-size: 22px;
  font-weight: 700;
  text-align: center;
  color: #003366;
}

/* === ROW KIRI–KANAN UNTUK KARTU === */
.krn-row {
  flex: 1;
  display: flex;
  flex-direction: row;
  gap: 12px;
}

/* === KARTU DENGAN GAMBAR DI ATAS & TEKS DI BAWAH === */
.krn-card {
  flex: 1;
  border-radius: 18px;
  display: flex;
  flex-direction: column;      /* gambar atas, teks bawah */
  align-items: center;
  justify-content: center;
  padding: 10px;
  gap: 8px;
  font-size: 18px;
  font-weight: 600;
  text-align: center;
  color: white;
  box-shadow: 0 4px 15px #00000030;
  border: none;
  transition: .15s;
}

.krn-card img {
  width: 60%;
  height: auto;
  object-fit: contain;
}

.card-green  { background: #1FA855; }
.card-orange { background: #FF8A2B; }
.card-blue   { background: #2F5597; }
.card-purple { background: #7030A0; }

.krn-card:active { transform: scale(.97); box-shadow: 0 2px 8px #00000022; }

/* Admin */
.admin-form {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin: 0 4px 10px;
}

.admin-form label { font-size: 14px; }

.admin-form input {
  padding: 8px 10px;
  border-radius: 8px;
  border: 1px solid #999;
  font-size: 14px;
}

.admin-btn {
  margin-top: 10px;
  padding: 10px;
  border-radius: 12px;
  border: none;
  background: #7030A0;
  color: white;
  font-weight: 600;
  font-size: 16px;
  margin-left: 4px;
  margin-right: 4px;
}
.admin-btn:active { transform: scale(.97); }
</style>
</head>

<body>

<div class="excel-wrapper">
  <div class="title-bar" id="colorBar"></div>

  <div class="content-area">
    <div class="inner-content" id="innerContent">
      <div class="zoom-wrapper" id="zoomWrapper">
        <div id="contentArea">Memuat...</div>
      </div>
    </div>

    <div class="title-bar" id="colorBar2"></div>

    <div class="sheet-tabs-bar" id="tabsBar">

      <div class="sheet-tab active" data-file="inline-azmil" data-color="#107C41">
        KRN<br>Bu Azmil
      </div>

      <div class="sheet-tab" data-file="inline-hexing" data-color="#2F5597">
        KRN<br>Hexing
      </div>

      <div class="sheet-tab" data-file="inline-sanxing" data-color="#C55A11">
        KRN<br>Sanxing
      </div>

      <div class="sheet-tab" data-file="inline-admin" data-color="#7030A0">
        Admin<br>login
      </div>

    </div>
  </div>
</div>

<script>
/* ==========================================================
   INLINE CONTENT — WITH IMAGES IN BUTTONS
========================================================== */

const INLINE_AZMIL = `
  <div class="krn-box">
    <div class="krn-title">KRN Bu Azmil</div>
    <img class="krn-img" src="asset/hd1.webp">

    <div class="krn-row">
      <div class="krn-card card-green" onclick="alert('Pemasangan Bu Azmil')">
        <img src="asset/pemasangan.webp">
        <span>Pemasangan</span>
      </div>

      <div class="krn-card card-orange" onclick="alert('Laporan Bu Azmil')">
        <img src="asset/lap.webp">
        <span>Lihat Laporan</span>
      </div>
    </div>
  </div>
`;

const INLINE_HEXING = `
  <div class="krn-box">
    <div class="krn-title">KRN Hexing</div>
    <img class="krn-img" src="asset/hd1.webp">

    <div class="krn-row">
      <div class="krn-card card-green" onclick="alert('Pemasangan Hexing')">
        <img src="asset/pemasangan.webp">
        <span>Pemasangan</span>
      </div>

      <div class="krn-card card-orange" onclick="alert('Laporan Hexing')">
        <img src="asset/lap.webp">
        <span>Lihat Laporan</span>
      </div>
    </div>
  </div>
`;

const INLINE_SANXING = `
  <div class="krn-box">
    <div class="krn-title">KRN Sanxing</div>
    <img class="krn-img" src="asset/hd1.webp">

    <div class="krn-row">
      <div class="krn-card card-green" onclick="alert('Pemasangan Sanxing')">
        <img src="asset/pemasangan.webp">
        <span>Pemasangan</span>
      </div>

      <div class="krn-card card-orange" onclick="alert('Laporan Sanxing')">
        <img src="asset/lap.webp">
        <span>Lihat Laporan</span>
      </div>
    </div>
  </div>
`;

const INLINE_ADMIN = `
  <div class="krn-box">
    <div class="krn-title">Admin Area</div>
    <div class="admin-form">
      <label>Username</label>
      <input type="text">
      <label>Password</label>
      <input type="password">
      <button class="admin-btn" onclick="alert('Login')">Login</button>
    </div>
  </div>
`;

/* ==========================================================
   TAB SYSTEM
========================================================== */

const tabs=document.querySelectorAll(".sheet-tab");
const contentArea=document.getElementById("contentArea");
const colorBar=document.getElementById("colorBar");
const colorBar2=document.getElementById("colorBar2");
const tabsBar=document.getElementById("tabsBar");
const innerContent=document.getElementById("innerContent");
const zoomWrapper=document.getElementById("zoomWrapper");

let currentIndex=0;

function getInlineContent(src){
  if(src==="inline-azmil")return INLINE_AZMIL;
  if(src==="inline-hexing")return INLINE_HEXING;
  if(src==="inline-sanxing")return INLINE_SANXING;
  if(src==="inline-admin")return INLINE_ADMIN;
  return "Error";
}

function loadPage(src,dir){
  contentArea.innerHTML=getInlineContent(src);

  zoomWrapper.classList.remove("slide-from-right","slide-from-left");
  void zoomWrapper.offsetWidth;
  zoomWrapper.classList.add(dir==="right"?"slide-from-right":"slide-from-left");
}

function applyTheme(tab){
  const c=tab.dataset.color, g=c+"88";
  tab.style.setProperty("--activeColor",c);
  tab.style.setProperty("--glowColor",g);
  colorBar.style.background=c;
  colorBar2.style.background=c;
  tabsBar.style.background=c;
}

function applyRadius(i){
  tabs.forEach(t=>t.style.borderRadius='0');
  if(i===0)tabs[1].style.borderRadius="10px 0 0 0";
  if(i===1){tabs[0].style.borderRadius="0 10px 0 0";tabs[2].style.borderRadius="10px 0 0 0";}
  if(i===2){tabs[1].style.borderRadius="0 10px 0 0";tabs[3].style.borderRadius="10px 0 0 0";}
  if(i===3)tabs[2].style.borderRadius="0 10px 0 0";
}

(function init(){
  applyTheme(tabs[0]);
  applyRadius(0);
  loadPage("inline-azmil","right");
})();

tabs.forEach((tab,i)=>{
  tab.addEventListener("click",()=>{
    if(i===currentIndex)return;
    const dir=i>currentIndex?"right":"left";
    tabs.forEach(t=>t.classList.remove("active"));
    tab.classList.add("active");
    applyTheme(tab);
    applyRadius(i);
    loadPage(tab.dataset.file,dir);
    currentIndex=i;
  });
});

/* ==========================================================
   PINCH ZOOM
========================================================== */

let currentScale=1,startScale=1,startDistance=0;
const minScale=1;
const maxScale=1.8;

function distance(t1,t2){ return Math.hypot(t2.clientX-t1.clientX,t2.clientY-t1.clientY); }
function applyZoom(){ zoomWrapper.style.transform=`scale(${currentScale})`; }

innerContent.addEventListener("touchstart",e=>{
  if(e.touches.length===2){
    e.preventDefault();
    startDistance=distance(e.touches[0],e.touches[1]);
    startScale=currentScale;
  }
},{passive:false});

innerContent.addEventListener("touchmove",e=>{
  if(e.touches.length===2){
    e.preventDefault();
    const newDist=distance(e.touches[0],e.touches[1]);
    const factor=newDist/startDistance;
    currentScale=Math.min(maxScale,Math.max(minScale,startScale*factor));
    applyZoom();
  }
},{passive:false});

applyZoom();
</script>
</body>
      </html>
